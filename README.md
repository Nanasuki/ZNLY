

## 项目演示
[![Watch the video](https://raw.github.com/GabLeRoux/WebMole/master/ressources/WebMole_Youtube_Video.png)](assets/%E6%BC%94%E7%A4%BA.mp4)

## 专利受理
![本地路径](assets/%E4%B8%93%E5%88%A9.png)

## 算法架构
### 2 概要设计
#### 2.1 系统架构
展现层使用微信小程序，通讯层使用HTTP/HTTPS通信方式实现前后端数据通信，服务层使用基于nodejs的thinkjs框架搭建，数据层使用mysql数据库进行数据存储。
#### 2.2 数据库设计

    数据库主要包含两张表，一张存储用户个人信息，包含自增主键，手机号，密码，年龄，身高，体重等字段；一张存储用户身体尺寸数据，包含胸围，腰围，臀围等字段。


3 详细设计
3.1 量体算法
针对量体算法，首先设计图片编码方案，然后从八个方位拍摄图片并保存至后台服务器，采用目标检测算法提取图片中的有效区域，再用定位算法定位编码图案位置，利用定位好的编码图片位置用测距算法测得个部位的尺寸，最终将测量结果返回给用户并保存至后台服务器。具体如图3-1所示。

![本地路径](assets/%E5%9B%BE%E7%89%873-1.png)

图3-1 总体算法流程设计

##### 3.1.1 编码图案定位模块
（1）程序描述：
该模块主要实现编码图案中心点坐标定位功能，包括get_centre.py以及get_all_center.py两个功能函数，模块具体实现功能.
输入	处理	输出
所有所需编码图案的编号（由config.py提供编码图案键值）	

1.根据FLANN的匹配器(FLANN based Matcher)定位编码图案中心点坐标

2.在1的基础上进行八张图片编码图案的定位	提取八张图片中所需图案编码的中心点坐标以及像素直径


（2）算法实现流程图

![本地路径](assets/%E5%9B%BE%E7%89%873-2.png)


图3-2 编码图案定位算法设计流程图

3.1.2 基本小段测距模块

（1）程序描述

该模块主要实现编码之间的小段距离计算，包括detection文件中的get_allcendic_list.py、judege_len_dic.py以及gather_dic_list.py三个个.py文件中的函数，模块具体实现功能如表3-2所示。
输入	处理	输出
1.每个编码图案的中心点坐标以及像素直径（由定位模块提供）
2.编码组合列表（由opt.py提供编码图案键值）	1.根据输入的每张图的中心坐标和编码像素直径计算需要的小段距离
2.通过gather_dic_list.py将八张图片的小段距离汇集在一起
3.利用judege_len_dic.py判断汇集在一起的小段距离是否合理	所有的小段距离（分为竖直、横向）
表3-2

(2)算法设计流程图

![本地路径](assets/%E5%9B%BE%E7%89%873-3.png)

图3-3 测距算法流程图
3.1.3 尺寸测量模块

（1）程序描述
该模块主要实现某一部位或者围度长度测量功能，包括measure文件中的all_lenth_dic.py、all_size.py文件中的函数，模块具体实现功能如表3-3所示。
输入	处理	输出
1.所有的小段距离
2.编码组合列表（由opt.py提供编码图案键值）	1.根据opt.py文件中的编码信息，将不同的小段距离组合成不同的尺寸
	某一特定部位（围度、长度、宽度）的尺寸



3.1.3 辅助函数模块

辅助函数模块是用来辅助编码图案定位与测距辅助测量距离函数，其中辅助测量距离len_fun函数是计算两个坐标点间的距离，分为计算。
对于len_fun函数，具体实现功能如表3-3所示。
输入	操作
1.一张图片上所有编码的中心点坐标、像素直径
2.opt.py文件中所有需要求的小段距离的编码信息	利用编码的真实直径和像素直径的关系，求出编码间的距离。


## Install dependencies

```
npm install
```

## Start server

```
npm start
```

## Deploy with pm2

Use pm2 to deploy app on production enviroment.

```
pm2 startOrReload pm2.json
```